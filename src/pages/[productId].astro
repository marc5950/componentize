---
import "../styles/global.css";
import Header from "../components/Header.astro";
import Hero from "../components/Hero.astro";
import Footer from "../components/Footer.astro";
import Card from "../components/Card.astro";

// Hent alle produkter
export async function getStaticPaths() {
  const fashionUrl = "https://kea-alt-del.dk/t7/api/products?limit=40";
  const products = await fetch(fashionUrl).then((res) => res.json());

  // Opret stier for hvert produkt
  return products.map((product) => ({
    params: { productId: product.id.toString() },
    props: { productId: product.id.toString() },
  }));
}

// Hent den specifikke produktId fra ruten
const { productId } = Astro.params;

// Hent det specifikke produkts data
const fashionUrl = `https://kea-alt-del.dk/t7/api/products/${productId}`;
const data = await fetch(fashionUrl).then((res) => res.json());
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <title>{data.productdisplayname}</title>
  </head>
  <body>
    <Header />
    <main>
      <Hero />
      <div class="produktliste">
        <Card product={data} />
      </div>
    </main>
    <Footer />
  </body>
</html>
